<template>
  <div style="width: 48%" @click="viewProduct(product)">
    <v-card rounded="lg" class="pa-3" elevation="0" style="width: 100%;">
      <v-row>
        <v-img
          :src="product.product_image"
          lazy-src="https://picsum.photos/id/11/100/60"
          style="width: 100%; height: 100px;border-radius: 8px;"
        >
          <template v-slot:placeholder>
            <v-row class="fill-height ma-0" align="center" justify="center">
              <v-progress-circular
                indeterminate
                color="grey lighten-5"
              ></v-progress-circular>
            </v-row>
          </template>
        </v-img>
        <div class="text-left" style="width: 100%">
          <h2 class="mt-2 block">{{ product.product_name }}</h2>
          <p class="text-subtitle-2">N{{ product.price }}</p>
          <p class="text-caption text-left" style="line-height: 1rem">
            {{ product.description }}
          </p>
          <div style="display: flex; align-items: center" v-if="product.review_count == 0" @click="viewReview(product)">
            <svg
              width="80"
              height="16"
              viewBox="0 0 80 16"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M12.883 7.70726C13.5503 7.12817 13.1937 6.03163 12.3135 5.95573L10.4735 5.79706C10.1046 5.76525 9.78353 5.53227 9.63888 5.19148L8.92185 3.50226C8.57693 2.68966 7.42511 2.68997 7.08063 3.50276L6.36263 5.19682C6.2179 5.53832 5.89603 5.77165 5.52645 5.80301L3.69562 5.95834C2.81419 6.03312 2.45678 7.13138 3.12538 7.71058L4.51778 8.91682C4.79834 9.15987 4.92119 9.53834 4.83686 9.89983L4.41906 11.6907C4.2181 12.5522 5.15233 13.2312 5.90965 12.7741L7.48392 11.8239C7.80171 11.6321 8.19959 11.6321 8.51739 11.8239L10.0955 12.7764C10.8522 13.2331 11.786 12.5554 11.5864 11.6944L11.17 9.89852C11.0863 9.5377 11.2089 9.16019 11.4887 8.91742L12.883 7.70726ZM8.51051 10.5737C8.19767 10.3845 7.80463 10.3837 7.49164 10.5727C6.74632 11.0226 5.82724 10.3523 6.02533 9.50456C6.10849 9.14863 5.98753 8.77518 5.71142 8.53567C5.052 7.96364 5.4068 6.87874 6.27648 6.80329C6.63927 6.77182 6.95588 6.54208 7.09741 6.20657C7.43484 5.40668 8.57046 5.41158 8.90885 6.21105C9.05109 6.5471 9.36884 6.7785 9.73238 6.81004C10.6021 6.88549 10.9557 7.97058 10.2962 8.5426C10.0204 8.78191 9.89933 9.15463 9.98242 9.51026C10.1806 10.3585 9.25592 11.0245 8.51051 10.5737Z"
                fill="#AAB2BD"
              />
              <path
                d="M28.883 7.70726C29.5503 7.12817 29.1937 6.03163 28.3135 5.95573L26.4735 5.79706C26.1046 5.76525 25.7835 5.53227 25.6389 5.19148L24.9219 3.50226C24.5769 2.68966 23.4251 2.68997 23.0806 3.50276L22.3626 5.19682C22.2179 5.53832 21.896 5.77165 21.5265 5.80301L19.6956 5.95834C18.8142 6.03312 18.4568 7.13138 19.1254 7.71058L20.5178 8.91682C20.7983 9.15987 20.9212 9.53834 20.8369 9.89983L20.4191 11.6907C20.2181 12.5522 21.1523 13.2312 21.9097 12.7741L23.4839 11.8239C23.8017 11.6321 24.1996 11.6321 24.5174 11.8239L26.0955 12.7764C26.8522 13.2331 27.786 12.5554 27.5864 11.6944L27.17 9.89852C27.0863 9.5377 27.2089 9.16019 27.4887 8.91742L28.883 7.70726ZM24.5105 10.5737C24.1977 10.3845 23.8046 10.3837 23.4916 10.5727C22.7463 11.0226 21.8272 10.3523 22.0253 9.50456C22.1085 9.14863 21.9875 8.77518 21.7114 8.53567C21.052 7.96364 21.4068 6.87874 22.2765 6.80329C22.6393 6.77182 22.9559 6.54208 23.0974 6.20657C23.4348 5.40668 24.5705 5.41158 24.9089 6.21105C25.0511 6.5471 25.3688 6.7785 25.7324 6.81004C26.6021 6.88549 26.9557 7.97058 26.2962 8.5426C26.0204 8.78191 25.8993 9.15463 25.9824 9.51026C26.1806 10.3585 25.2559 11.0245 24.5105 10.5737Z"
                fill="#AAB2BD"
              />
              <path
                d="M44.883 7.70726C45.5503 7.12817 45.1937 6.03163 44.3135 5.95573L42.4735 5.79706C42.1046 5.76525 41.7835 5.53227 41.6389 5.19148L40.9219 3.50226C40.5769 2.68966 39.4251 2.68997 39.0806 3.50276L38.3626 5.19682C38.2179 5.53832 37.896 5.77165 37.5265 5.80301L35.6956 5.95834C34.8142 6.03312 34.4568 7.13138 35.1254 7.71058L36.5178 8.91682C36.7983 9.15987 36.9212 9.53834 36.8369 9.89983L36.4191 11.6907C36.2181 12.5522 37.1523 13.2312 37.9097 12.7741L39.4839 11.8239C39.8017 11.6321 40.1996 11.6321 40.5174 11.8239L42.0955 12.7764C42.8522 13.2331 43.786 12.5554 43.5864 11.6944L43.17 9.89852C43.0863 9.5377 43.2089 9.16019 43.4887 8.91742L44.883 7.70726ZM40.5105 10.5737C40.1977 10.3845 39.8046 10.3837 39.4916 10.5727C38.7463 11.0226 37.8272 10.3523 38.0253 9.50456C38.1085 9.14863 37.9875 8.77518 37.7114 8.53567C37.052 7.96364 37.4068 6.87874 38.2765 6.80329C38.6393 6.77182 38.9559 6.54208 39.0974 6.20657C39.4348 5.40668 40.5705 5.41158 40.9089 6.21105C41.0511 6.5471 41.3688 6.7785 41.7324 6.81004C42.6021 6.88549 42.9557 7.97058 42.2962 8.5426C42.0204 8.78191 41.8993 9.15463 41.9824 9.51026C42.1806 10.3585 41.2559 11.0245 40.5105 10.5737Z"
                fill="#AAB2BD"
              />
              <path
                d="M60.883 7.70726C61.5503 7.12817 61.1937 6.03163 60.3135 5.95573L58.4735 5.79706C58.1046 5.76525 57.7835 5.53227 57.6389 5.19148L56.9219 3.50226C56.5769 2.68966 55.4251 2.68997 55.0806 3.50276L54.3626 5.19682C54.2179 5.53832 53.896 5.77165 53.5265 5.80301L51.6956 5.95834C50.8142 6.03312 50.4568 7.13138 51.1254 7.71058L52.5178 8.91682C52.7983 9.15987 52.9212 9.53834 52.8369 9.89983L52.4191 11.6907C52.2181 12.5522 53.1523 13.2312 53.9097 12.7741L55.4839 11.8239C55.8017 11.6321 56.1996 11.6321 56.5174 11.8239L58.0955 12.7764C58.8522 13.2331 59.786 12.5554 59.5864 11.6944L59.17 9.89852C59.0863 9.5377 59.2089 9.16019 59.4887 8.91742L60.883 7.70726ZM56.5105 10.5737C56.1977 10.3845 55.8046 10.3837 55.4916 10.5727C54.7463 11.0226 53.8272 10.3523 54.0253 9.50456C54.1085 9.14863 53.9875 8.77518 53.7114 8.53567C53.052 7.96364 53.4068 6.87874 54.2765 6.80329C54.6393 6.77182 54.9559 6.54208 55.0974 6.20657C55.4348 5.40668 56.5705 5.41158 56.9089 6.21105C57.0511 6.5471 57.3688 6.7785 57.7324 6.81004C58.6021 6.88549 58.9557 7.97058 58.2962 8.5426C58.0204 8.78191 57.8993 9.15463 57.9824 9.51026C58.1806 10.3585 57.2559 11.0245 56.5105 10.5737Z"
                fill="#AAB2BD"
              />
              <path
                d="M76.883 7.70726C77.5503 7.12817 77.1937 6.03163 76.3135 5.95573L74.4735 5.79706C74.1046 5.76525 73.7835 5.53227 73.6389 5.19148L72.9219 3.50226C72.5769 2.68966 71.4251 2.68997 71.0806 3.50276L70.3626 5.19682C70.2179 5.53832 69.896 5.77165 69.5265 5.80301L67.6956 5.95834C66.8142 6.03312 66.4568 7.13138 67.1254 7.71058L68.5178 8.91682C68.7983 9.15987 68.9212 9.53834 68.8369 9.89983L68.4191 11.6907C68.2181 12.5522 69.1523 13.2312 69.9097 12.7741L71.4839 11.8239C71.8017 11.6321 72.1996 11.6321 72.5174 11.8239L74.0955 12.7764C74.8522 13.2331 75.786 12.5554 75.5864 11.6944L75.17 9.89852C75.0863 9.5377 75.2089 9.16019 75.4887 8.91742L76.883 7.70726ZM72.5105 10.5737C72.1977 10.3845 71.8046 10.3837 71.4916 10.5727C70.7463 11.0226 69.8272 10.3523 70.0253 9.50456C70.1085 9.14863 69.9875 8.77518 69.7114 8.53567C69.052 7.96364 69.4068 6.87874 70.2765 6.80329C70.6393 6.77182 70.9559 6.54208 71.0974 6.20657C71.4348 5.40668 72.5705 5.41158 72.9089 6.21105C73.0511 6.5471 73.3688 6.7785 73.7324 6.81004C74.6021 6.88549 74.9557 7.97058 74.2962 8.5426C74.0204 8.78191 73.8993 9.15463 73.9824 9.51026C74.1806 10.3585 73.2559 11.0245 72.5105 10.5737Z"
                fill="#AAB2BD"
              />
            </svg>
            <span class="ml-2 text-caption">{{product.review_count}} reviews</span>
          </div>
          <div style="display: flex; align-items: center" v-else @click="viewReview(product)">
           <svg width="80" height="16" viewBox="0 0 80 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M7.48392 11.8239C7.80171 11.6321 8.19959 11.6321 8.51739 11.8239L10.0917 12.7741C10.849 13.2312 11.7832 12.5522 11.5822 11.6907L11.1644 9.89983C11.0801 9.53834 11.203 9.15987 11.4835 8.91682L12.8759 7.71058C13.5445 7.13138 13.1871 6.03312 12.3057 5.95834L10.4748 5.80301C10.1053 5.77165 9.78341 5.53832 9.63867 5.19682L8.92137 3.5044C8.57678 2.69137 7.42452 2.69137 7.07993 3.5044L6.36263 5.19682C6.2179 5.53832 5.89603 5.77165 5.52645 5.80301L3.69562 5.95834C2.81419 6.03312 2.45678 7.13138 3.12538 7.71058L4.51778 8.91682C4.79834 9.15987 4.92119 9.53834 4.83686 9.89983L4.41906 11.6907C4.2181 12.5522 5.15233 13.2312 5.90965 12.7741L7.48392 11.8239Z" fill="#F8A401"/>
<path d="M23.4839 11.8239C23.8017 11.6321 24.1996 11.6321 24.5174 11.8239L26.0917 12.7741C26.849 13.2312 27.7832 12.5522 27.5822 11.6907L27.1644 9.89983C27.0801 9.53834 27.203 9.15987 27.4835 8.91682L28.8759 7.71058C29.5445 7.13138 29.1871 6.03312 28.3057 5.95834L26.4748 5.80301C26.1053 5.77165 25.7834 5.53832 25.6387 5.19682L24.9214 3.5044C24.5768 2.69137 23.4245 2.69137 23.0799 3.5044L22.3626 5.19682C22.2179 5.53832 21.896 5.77165 21.5265 5.80301L19.6956 5.95834C18.8142 6.03312 18.4568 7.13138 19.1254 7.71058L20.5178 8.91682C20.7983 9.15987 20.9212 9.53834 20.8369 9.89983L20.4191 11.6907C20.2181 12.5522 21.1523 13.2312 21.9097 12.7741L23.4839 11.8239Z" fill="#F8A401"/>
<path d="M39.4839 11.8239C39.8017 11.6321 40.1996 11.6321 40.5174 11.8239L42.0917 12.7741C42.849 13.2312 43.7832 12.5522 43.5822 11.6907L43.1644 9.89983C43.0801 9.53834 43.203 9.15987 43.4835 8.91682L44.8759 7.71058C45.5445 7.13138 45.1871 6.03312 44.3057 5.95834L42.4748 5.80301C42.1053 5.77165 41.7834 5.53832 41.6387 5.19682L40.9214 3.5044C40.5768 2.69137 39.4245 2.69137 39.0799 3.5044L38.3626 5.19682C38.2179 5.53832 37.896 5.77165 37.5265 5.80301L35.6956 5.95834C34.8142 6.03312 34.4568 7.13138 35.1254 7.71058L36.5178 8.91682C36.7983 9.15987 36.9212 9.53834 36.8369 9.89983L36.4191 11.6907C36.2181 12.5522 37.1523 13.2312 37.9097 12.7741L39.4839 11.8239Z" fill="#F8A401"/>
<path d="M60.883 7.70726C61.5503 7.12817 61.1937 6.03163 60.3135 5.95573L58.4735 5.79706C58.1046 5.76525 57.7835 5.53227 57.6389 5.19148L56.9219 3.50226C56.5769 2.68966 55.4251 2.68997 55.0806 3.50276L54.3626 5.19682C54.2179 5.53832 53.896 5.77165 53.5265 5.80301L51.6956 5.95834C50.8142 6.03312 50.4568 7.13138 51.1254 7.71058L52.5178 8.91682C52.7983 9.15987 52.9212 9.53834 52.8369 9.89983L52.4191 11.6907C52.2181 12.5522 53.1523 13.2312 53.9097 12.7741L55.4839 11.8239C55.8017 11.6321 56.1996 11.6321 56.5174 11.8239L58.0955 12.7764C58.8522 13.2331 59.786 12.5554 59.5864 11.6944L59.17 9.89852C59.0863 9.5377 59.2089 9.16019 59.4887 8.91742L60.883 7.70726ZM56.483 10.5571C56.1836 10.376 56.0007 10.0515 56.0007 9.70161V6.67163C56.0007 6.0952 56.7919 5.93464 57.0165 6.46548C57.0929 6.64587 57.2627 6.76929 57.4579 6.78622L57.7356 6.81031C58.6053 6.88577 58.9557 7.97058 58.2962 8.5426C58.0204 8.78191 57.8993 9.15463 57.9824 9.51026C58.1806 10.3585 57.2602 11.0271 56.5148 10.5763L56.483 10.5571Z" fill="#F8A401"/>
<path d="M76.883 7.70726C77.5503 7.12817 77.1937 6.03163 76.3135 5.95573L74.4735 5.79706C74.1046 5.76525 73.7835 5.53227 73.6389 5.19148L72.9219 3.50226C72.5769 2.68966 71.4251 2.68997 71.0806 3.50276L70.3626 5.19682C70.2179 5.53832 69.896 5.77165 69.5265 5.80301L67.6956 5.95834C66.8142 6.03312 66.4568 7.13138 67.1254 7.71058L68.5178 8.91682C68.7983 9.15987 68.9212 9.53834 68.8369 9.89983L68.4191 11.6907C68.2181 12.5522 69.1523 13.2312 69.9097 12.7741L71.4839 11.8239C71.8017 11.6321 72.1996 11.6321 72.5174 11.8239L74.0955 12.7764C74.8522 13.2331 75.786 12.5554 75.5864 11.6944L75.17 9.89852C75.0863 9.5377 75.2089 9.16019 75.4887 8.91742L76.883 7.70726ZM72.5105 10.5737C72.1977 10.3845 71.8046 10.3837 71.4916 10.5727C70.7463 11.0226 69.8272 10.3523 70.0253 9.50456C70.1085 9.14863 69.9875 8.77518 69.7114 8.53567C69.052 7.96364 69.4068 6.87874 70.2765 6.80329C70.6393 6.77182 70.9559 6.54208 71.0974 6.20657C71.4348 5.40668 72.5705 5.41158 72.9089 6.21105C73.0511 6.5471 73.3688 6.7785 73.7324 6.81004C74.6021 6.88549 74.9557 7.97058 74.2962 8.5426C74.0204 8.78191 73.8993 9.15463 73.9824 9.51026C74.1806 10.3585 73.2559 11.0245 72.5105 10.5737Z" fill="#F8A401"/>
</svg>

            <span class="ml-2 text-caption">{{product.review_count}} reviews</span>
          </div>
        </div>

        <!-- <v-col class="pa-0" cols="2">
          <v-img
            :src="product.product_image"
            lazy-src="https://picsum.photos/id/11/100/60"
            style="width: auto; height: 50px"
            class="rounded"
          >
            <template v-slot:placeholder>
              <v-row
                class="fill-height ma-0"
                align="center"
                justify="center"
              >
                <v-progress-circular
                  indeterminate
                  color="grey lighten-5"
                ></v-progress-circular>
              </v-row>
            </template>
          </v-img>
        </v-col>
        <v-col
          cols=6
          class="pa-0 pl-2"
          style="position: relative"
        >
        <div>
           <p class="ma-0 pr-5 text-subtitle-2 text-left">{{product.product_name}}</p>
          <p class="ma-0 pr-5 text-subtitle-2 text-left"> &#8358; {{product.price}}</p>
        </div>
         
         
        </v-col>
        <v-col
          cols=3
          class="pa-0"
          style="font-size: 16px;"
        >
          <p style="text-align: right" class="ma-0">
           
            >
          </p>
        
        </v-col> -->
      </v-row>
    </v-card>
  </div>
</template>

<script>
import * as mutationTypes from "@/store/mutationTypes";
import { EventBus } from "@/services/eventBus";
import { fethcStoreInventory, updateProduct } from "@/services/apiServices";

export default {
  name: "Product",
  props: ["product"],
  data: () => {
    return {
      display: false,
    };
  },
  methods: {
    toggleDisplay() {
      let data = { display: this.display };

      updateProduct(data, this.product.id)
        .then(() => {
          EventBus.$emit(
            "open_alert",
            "success",
            !this.product.display
              ? "This product has been added to your gallery. Your visitors will now see it when they visit."
              : "This product has been removed from your gallery. Your visitors will no longer see it."
          );
          fethcStoreInventory(this.product.slug); // perhaps fetch only this item and update it
        })
        .catch((err) => {
          EventBus.$emit(
            "open_alert",
            "error",
            `There was an error changing display status ${err}`
          );
        })
        .finally(() => {
          this.loading = false;
        });
    },
    viewProduct(product) {
      this.$store.commit(mutationTypes.SET_PRODUCT_TO_BE_EDITTED, product);
      this.$emit("viewProduct");
    },
    viewReview(product) {
      this.$store.commit(mutationTypes.SET_PRODUCT_TO_BE_EDITTED, product);
      this.$emit("viewProductReview");
    },
  },
  mounted() {
    this.display = this.product.display;
    // console.log(this.product)
  },
};
</script>
